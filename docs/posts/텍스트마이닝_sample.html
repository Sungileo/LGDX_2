<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="박성일">
<meta name="dcterms.date" content="2024-07-30">
<meta name="description" content="텍스트마이닝을 해보아요">

<title> - 텍스트마이닝</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title"><img src="https://cdn.imweb.me/thumbnail/20240422/007568c9f6705.png" alt="LG EDX Title" class="title_img"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://dxschool.co.kr/" rel="" target="">
 <span class="menu-text">공식 홈페이지</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#텍스트마이닝" id="toc-텍스트마이닝" class="nav-link active" data-scroll-target="#텍스트마이닝">텍스트마이닝</a>
  <ul class="collapse">
  <li><a href="#텍스트-데이터의-전처리" id="toc-텍스트-데이터의-전처리" class="nav-link" data-scroll-target="#텍스트-데이터의-전처리">1. 텍스트 데이터의 전처리</a>
  <ul class="collapse">
  <li><a href="#토큰화tokenize" id="toc-토큰화tokenize" class="nav-link" data-scroll-target="#토큰화tokenize">1-1. 토큰화(Tokenize)</a></li>
  <li><a href="#텍스트-전처리-정규표현식과-텍스트-필터링" id="toc-텍스트-전처리-정규표현식과-텍스트-필터링" class="nav-link" data-scroll-target="#텍스트-전처리-정규표현식과-텍스트-필터링">1-2. 텍스트 전처리 (정규표현식과 텍스트 필터링)</a></li>
  <li><a href="#텍스트-전처리-형태소-단위-분리" id="toc-텍스트-전처리-형태소-단위-분리" class="nav-link" data-scroll-target="#텍스트-전처리-형태소-단위-분리">1-3. 텍스트 전처리 (형태소 단위 분리)</a></li>
  </ul></li>
  <li><a href="#텍스트-데이터-변환" id="toc-텍스트-데이터-변환" class="nav-link" data-scroll-target="#텍스트-데이터-변환">2. 텍스트 데이터 변환</a>
  <ul class="collapse">
  <li><a href="#bow-bag-of-words" id="toc-bow-bag-of-words" class="nav-link" data-scroll-target="#bow-bag-of-words">2-1. BOW (Bag-of-Words)</a></li>
  <li><a href="#tf-idf-term-frequency-inverse-document-frequency" id="toc-tf-idf-term-frequency-inverse-document-frequency" class="nav-link" data-scroll-target="#tf-idf-term-frequency-inverse-document-frequency">2-2. TF-IDF (Term Frequency-Inverse Document Frequency)</a></li>
  <li><a href="#sentencetransformer" id="toc-sentencetransformer" class="nav-link" data-scroll-target="#sentencetransformer">2-3. SentenceTransformer</a></li>
  </ul></li>
  <li><a href="#모델-적용-분류-classification" id="toc-모델-적용-분류-classification" class="nav-link" data-scroll-target="#모델-적용-분류-classification">3. 모델 적용 (분류, Classification)</a>
  <ul class="collapse">
  <li><a href="#데이터-변환-적용" id="toc-데이터-변환-적용" class="nav-link" data-scroll-target="#데이터-변환-적용">3-1. 데이터 변환 적용</a></li>
  <li><a href="#모델-적용-로지스틱-회귀-분석" id="toc-모델-적용-로지스틱-회귀-분석" class="nav-link" data-scroll-target="#모델-적용-로지스틱-회귀-분석">3-2. 모델 적용 (로지스틱 회귀 분석)</a></li>
  </ul></li>
  <li><a href="#성능-지표-해석" id="toc-성능-지표-해석" class="nav-link" data-scroll-target="#성능-지표-해석">4. 성능 지표 해석</a></li>
  <li><a href="#파이프라인-하이퍼파라미터-튜닝" id="toc-파이프라인-하이퍼파라미터-튜닝" class="nav-link" data-scroll-target="#파이프라인-하이퍼파라미터-튜닝">5. 파이프라인 &amp; 하이퍼파라미터 튜닝</a>
  <ul class="collapse">
  <li><a href="#파이프라인" id="toc-파이프라인" class="nav-link" data-scroll-target="#파이프라인">5-1. 파이프라인</a></li>
  <li><a href="#하이퍼파라미터-튜닝" id="toc-하이퍼파라미터-튜닝" class="nav-link" data-scroll-target="#하이퍼파라미터-튜닝">5-2. 하이퍼파라미터 튜닝</a></li>
  </ul></li>
  <li><a href="#결과" id="toc-결과" class="nav-link" data-scroll-target="#결과">6. 결과</a>
  <ul class="collapse">
  <li><a href="#여성가족" id="toc-여성가족" class="nav-link" data-scroll-target="#여성가족">6-1. 여성/가족</a></li>
  <li><a href="#남성" id="toc-남성" class="nav-link" data-scroll-target="#남성">6-2. 남성</a></li>
  <li><a href="#성소수자" id="toc-성소수자" class="nav-link" data-scroll-target="#성소수자">6-3. 성소수자</a></li>
  <li><a href="#인종국적" id="toc-인종국적" class="nav-link" data-scroll-target="#인종국적">6-4. 인종/국적</a></li>
  <li><a href="#연령" id="toc-연령" class="nav-link" data-scroll-target="#연령">6-5. 연령</a></li>
  <li><a href="#지역" id="toc-지역" class="nav-link" data-scroll-target="#지역">6-6. 지역</a></li>
  <li><a href="#종교" id="toc-종교" class="nav-link" data-scroll-target="#종교">6-7. 종교</a></li>
  <li><a href="#기타-혐오" id="toc-기타-혐오" class="nav-link" data-scroll-target="#기타-혐오">6-8. 기타 혐오</a></li>
  <li><a href="#악플-욕설" id="toc-악플-욕설" class="nav-link" data-scroll-target="#악플-욕설">6-9. 악플/ 욕설</a></li>
  <li><a href="#clean" id="toc-clean" class="nav-link" data-scroll-target="#clean">6-10. clean</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">텍스트마이닝</h1>
</div>

<div>
  <div class="description">
    텍스트마이닝을 해보아요
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>박성일 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="텍스트마이닝" class="level1">
<h1>텍스트마이닝</h1>
<p>텍스트 마이닝이란 대량의 텍스트 데이터에서 유용한 정보와 패턴을 추출하고 분석하는 과정이다.</p>
<p>전체 데이터는 <code>문장</code>컬럼이 어떤 대상을 혐오하는지에 대한 데이터이고,<br> 분류 분석을 통해 문장의 어떤 특징이 분류 결과에 가중치를 주었는지를 보고자 한다.</p>
<section id="텍스트-데이터의-전처리" class="level2">
<h2 class="anchored" data-anchor-id="텍스트-데이터의-전처리">1. 텍스트 데이터의 전처리</h2>
<section id="토큰화tokenize" class="level3">
<h3 class="anchored" data-anchor-id="토큰화tokenize">1-1. 토큰화(Tokenize)</h3>
<p><strong>토큰화</strong>란 텍스트 데이터 처리에서 중요한 첫 단계로 텍스트를 분석하기 위해 작은 단위로 분할하는 과정을 의미한다.</p>
<p>토큰화의 목적은 텍스트를 단어, 문장, 구절 등 의미 있는 작은 단위로 나누어 기계가 이해할 수 있게 하는 것이다.</p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> <span class="st">'data/unsmile_train_v1.0.tsv'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(train_data, delimiter <span class="op">=</span> <span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> <span class="st">'data/unsmile_valid_v1.0.tsv'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(test_data, delimiter <span class="op">=</span> <span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">문장</th>
<th data-quarto-table-cell-role="th">여성/가족</th>
<th data-quarto-table-cell-role="th">남성</th>
<th data-quarto-table-cell-role="th">성소수자</th>
<th data-quarto-table-cell-role="th">인종/국적</th>
<th data-quarto-table-cell-role="th">연령</th>
<th data-quarto-table-cell-role="th">지역</th>
<th data-quarto-table-cell-role="th">종교</th>
<th data-quarto-table-cell-role="th">기타 혐오</th>
<th data-quarto-table-cell-role="th">악플/욕설</th>
<th data-quarto-table-cell-role="th">clean</th>
<th data-quarto-table-cell-role="th">개인지칭</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>일안하는 시간은 쉬고싶어서 그런게 아닐까</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>아동성범죄와 페도버는 기록바 끊어져 영원히 고통 받는다. 무슬림 50퍼 근친이다. ...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>루나 솔로앨범 나왔을 때부터 머모 기운 있었음 ㅇㅇ Keep o doin 진짜 띵...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>홍팍에도 어버이연합인가 보내요 뭐 이런뎃글 있는데 이거 어버이연합측에 신고하면 그쪽...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>아놔 왜 여기 댓들은 다 여자들이 김치녀라고 먼저 불렸다! 여자들은 더 심하게 그런...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>ntlk</code>는 자연어 처리에 사용되는 패키지이고, <code>word_tokenize</code>는 텍스트를 단어 단위로 분할하는데 사용된다.</p>
<p><code>punkt</code>는 <code>ntlk</code>에서 제공되는 패키지로, 텍스트를 토큰화하는데 필요한 알고리즘과 데이터가 있다.</p>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk <span class="im">import</span> word_tokenize</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'punkt'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[nltk_data] Downloading package punkt to /home/sungil/nltk_data...
[nltk_data]   Package punkt is already up-to-date!</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>True</code></pre>
</div>
</div>
<p><em>“넌 바라는게 너무 많아, 우리 헤어져”</em> 를 <code>word_tokenize()</code>로 토큰화하면 다음과 같다.</p>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>words <span class="op">=</span> word_tokenize(<span class="st">"넌 바라는게 너무 많아, 우리 헤어져"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>words</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>['넌', '바라는게', '너무', '많아', ',', '우리', '헤어져']</code></pre>
</div>
</div>
<p>전체 문장 토큰화</p>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>clean_token <span class="op">=</span> []</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> train[<span class="st">'문장'</span>]:</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> word_tokenize(i):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        clean_token.append(j)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 9개 값만 뽑아보기</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>clean_token[:<span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>['일안하는', '시간은', '쉬고싶어서', '그런게', '아닐까', '아동성범죄와', '페도버는', '기록바', '끊어져']</code></pre>
</div>
</div>
<p>토큰화된 텍스트 데이터에서 어떤 단어가 많이 나왔는지, 빈도를 세어 보고, 워드클라우드를 그려보았다.</p>
<p><code>Counter()</code> : 딕셔너리 형식으로 리스트 내의 값의 빈도 출력</p>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> Counter(clean_token)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 상위 15개 값만 추출</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>count.most_common(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>[('?', 3815),
 ('.', 3416),
 ('!', 2066),
 (',', 1174),
 ('..', 979),
 ('...', 905),
 ('다', 667),
 ('진짜', 543),
 ('왜', 540),
 ('ㅋㅋ', 435),
 ('존나', 376),
 ('그냥', 372),
 ('더', 368),
 ('ㅋㅋㅋ', 363),
 ('&gt;', 296)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>wc <span class="op">=</span> WordCloud(background_color <span class="op">=</span> <span class="st">'white'</span>, font_path<span class="op">=</span><span class="st">'/usr/share/fonts/truetype/nanum/NanumGothic.ttf'</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>wc.generate_from_frequencies(count)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>plt.imshow(wc)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>빈도를 세본 결과, 1글자(왜,다,더,좀..)와 “ㅋㅋㅋ”등 큰 의미가 없는 단어가 있었다.</strong></p>
</section>
<section id="텍스트-전처리-정규표현식과-텍스트-필터링" class="level3">
<h3 class="anchored" data-anchor-id="텍스트-전처리-정규표현식과-텍스트-필터링">1-2. 텍스트 전처리 (정규표현식과 텍스트 필터링)</h3>
<p>한글자 단어와, 기호, “ㅋㅋㅋ” 등 큰 의미가 없는 단어를 제거하면,</p>
<p>텍스트 데이터의 <strong>노이즈를 줄이고, 더 정확하고 유용한 정보를 추출</strong>할 수 있다.</p>
<hr>
<p>텍스트 데이터의 전처리를 위해 <code>re</code>패키지를 사용한다.</p>
<ul>
<li><p><code>re</code>패키지는 정규표현식을 사용하여 문자열을 조작하는 기능을 제공한다.</p></li>
<li><p><code>p = re.compile(pattern)</code>은 토큰에 <strong>pattern</strong>이 포함되어 있는지를 출력한다(True/False)</p></li>
<li><p><code>"[ㅋㅎㄷㅇ~!?.\\-ㅡ0-9a-z]+"</code> 패턴은 <strong>ㅋ, ㅎ, ㄷ, ㅇ, ~, !, ?, ., -, ㅡ, 숫자(0~9), 소문자 영어(a~z)</strong> 를 의미한다.</p></li>
</ul>
<hr>
<ol type="1">
<li><p>반복문을 사용하여 공백 기준으로 토큰화</p></li>
<li><p>토큰이 한 글자거나 pattern에 해당하면 스킵</p></li>
<li><p>스킵되지 않은 토큰들을 다시 문장으로 만들어 train clean 리스트에 넣기</p></li>
</ol>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> re.<span class="bu">compile</span>(<span class="st">"[ㅋㅎㄷㅇ~!?.</span><span class="ch">\\</span><span class="st">-ㅡ0-9a-z]+"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>train_clean <span class="op">=</span> [] </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> doc <span class="kw">in</span> train[<span class="st">'문장'</span>]:</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">=</span> []</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> token <span class="kw">in</span> doc.split(<span class="st">" "</span>):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(token) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p.search(token):</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        temp.append(token)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    train_clean.append(<span class="st">" "</span>.join(temp))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 테스트 데이터</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>test_clean <span class="op">=</span> []</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> doc <span class="kw">in</span> test[<span class="st">'문장'</span>]:</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">=</span> []</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> token <span class="kw">in</span> doc.split(<span class="st">" "</span>):</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(token) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p.search(token):</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        temp.append(token)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    test_clean.append(<span class="st">" "</span>.join(temp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>텍스트 데이터가 더 깔끔해진 것을 확인할 수 있다.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>train_clean[:<span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>['일안하는 시간은 쉬고싶어서 그런게 아닐까',
 '아동성범죄와 페도버는 기록바 끊어져 영원히 고통 무슬림 IQ 떨어지고 출산 위험은',
 '루나 솔로앨범 나왔을 때부터 머모 기운 있었음 진짜 띵곡임 들어보셈"',
 '홍팍에도 어버이연합인가 보내요 이런뎃글 있는데 이거 어버이연합측에 신고하면 그쪽에서 고소',
 '아놔 여기 댓들은 여자들이 김치녀라고 먼저 여자들은 심하게 이렇게 내가 둘다 나쁜 이상도 이하도 아닌데',
 '고향가서 피방가면 동네 부럴 친구들이랑은 거르는 없이 이야기하니까 말하게 되더라 당연히 키보드를 치거나 그러지는 않는데 말하는게 많이 거칠어지긴 반성해야겠네']</code></pre>
</div>
</div>
</section>
<section id="텍스트-전처리-형태소-단위-분리" class="level3">
<h3 class="anchored" data-anchor-id="텍스트-전처리-형태소-단위-분리">1-3. 텍스트 전처리 (형태소 단위 분리)</h3>
<p>한국어 문법 특성상 텍스트 데이터를 공백으로 나누는 것보다, <strong>형태소 단위</strong>로 나누면 텍스트의 의미를 더 정밀하게 분석할 수 있다.</p>
<hr>
<p>형태소 분리를 하기 위해 <code>konlpy</code>패키지를 사용한다.</p>
<p><code>konlpy</code> 패키지에는 <code>Hannanum</code>, <code>Kkma</code>, <code>Komoran</code>, <code>Mecab</code>, <code>Okt</code>등의 형태소 분석기가 있다.</p>
<p><code>morphs()</code>함수는 문장을 형태소 단위로 나누어준다.</p>
<p>다음은 형태소 단위 분리의 예시이다.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> konlpy.tag <span class="im">import</span> Okt, Kkma</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>okt <span class="op">=</span> Okt()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>t_1 <span class="op">=</span> <span class="st">"아버지가 방에 들어가신다"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>t_2 <span class="op">=</span> <span class="st">"아버지 가방에 들어가신다"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(okt.morphs(t_1))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(okt.morphs(t_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['아버지', '가', '방', '에', '들어가신다']
['아버지', '가방', '에', '들어가신다']</code></pre>
</div>
</div>
<p>형태소 단위 분리에 앞서 <code>emoji</code>패키지를 사용해 문장 내의 이모지를 제거하였다.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> emoji</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>train_clean <span class="op">=</span> [emoji.replace_emoji(tc) <span class="cf">for</span> tc <span class="kw">in</span> train_clean]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>test_clean <span class="op">=</span> [emoji.replace_emoji(tc) <span class="cf">for</span> tc <span class="kw">in</span> test_clean]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Kkma</code>형태소 분석기의 <code>morphs()</code> 함수를 사용하여 문장을 형태소로 분리, 리스트 형태로 저장.</p>
<p>train : test = 2700 : 1000 으로 사용</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>kkma <span class="op">=</span> Kkma()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>konlpy_morphs_train <span class="op">=</span> []</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> doc <span class="kw">in</span> tqdm(train_clean[:<span class="dv">2700</span>]):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  rs <span class="op">=</span> kkma.morphs(doc)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  konlpy_morphs_train.append(<span class="st">" "</span>.join(rs))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 테스트트</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>konlpy_morphs_test <span class="op">=</span> []</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> doc <span class="kw">in</span> tqdm(test_clean[:<span class="dv">1000</span>]): </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  rs <span class="op">=</span> kkma.morphs(doc)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  konlpy_morphs_test.append(<span class="st">" "</span>.join(rs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 0/2700 [00:00&lt;?, ?it/s]100%|██████████| 2700/2700 [00:37&lt;00:00, 72.91it/s] 
100%|██████████| 1000/1000 [00:12&lt;00:00, 81.21it/s]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>konlpy_morphs_train[:<span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>['일 안 하 는 시간 은 쉬 고 싶 어서 그러 ㄴ 것 이 아니 ㄹ까',
 '아동 성 범죄 와 페도버 는 기록 바 끊어지 어 영원히 고통 무슬림 IQ 떨어지 고 출산 위험 은',
 '루 나 솔로 앨범 나오 았 을 때 부터 머 모 기운 있 었 음 진짜 띵 곡 임 듣 어 보셈 "',
 '홍팍에 도 어버이 연합 이 ㄴ가 보 내요 이러 ㄴ 뎃 글 있 는데 이거 어버이 연합 측 에 신고 하면 그쪽 에서 고소',
 '아 아 노 아 여기 댓 듣 은 여자 들 이 김치 녀 라고 먼저 여자 들 은 심하 게 이렇 게 내가 둘 다 나쁘 ㄴ 이상 도 이하 도 아니 ㄴ데',
 '고향 가 아서 피 방가 이 면 동네 부 럴 치 ㄴ 구들 이랑 은 거르 는 없이 이야기 하 니까 말하 게 되 더라 당연히 키보드 를 치 거나 그러 지 는 않 는데 말하 는 것 이 많이 거칠어지 기 는 반성 하 어야 겠네']</code></pre>
</div>
</div>
</section>
</section>
<section id="텍스트-데이터-변환" class="level2">
<h2 class="anchored" data-anchor-id="텍스트-데이터-변환">2. 텍스트 데이터 변환</h2>
<p>kkma 형태소 분석기로 분리한 텍스트 데이터를, 모델에 적용하기 위해 숫자 형태로 바꾸어준다.</p>
<hr>
<section id="bow-bag-of-words" class="level3">
<h3 class="anchored" data-anchor-id="bow-bag-of-words">2-1. BOW (Bag-of-Words)</h3>
<p><strong>BOW(Bag-of-Words)</strong> 는 텍스트 데이터에서 각 단어의 빈도를 세어 숫자형 벡터로 변환하는 방법이다.</p>
<p><code>CountVectorizer</code>는 BOW방식으로 텍스트 데이터를 숫자형 피처 벡터로 변환해주는 <code>Scikit-learn</code>의 클래스이다.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sample_text <span class="op">=</span> [<span class="st">"나는 오늘 치킨을 먹을거야"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"너는 오늘 저녁에 무엇을 먹을거니"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"나는 오늘 아침에 운동을 하고 왔어"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"어제 저녁에 운동을 했더니 배가 고프다"</span>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>sample_bow <span class="op">=</span> CountVectorizer()</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>sample_bow.fit(sample_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>CountVectorizer()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">CountVectorizer</label><div class="sk-toggleable__content"><pre>CountVectorizer()</pre></div></div></div></div></div>
</div>
</div>
<p>예시 문장으로 만든 단어 사전 <code>sample_bow</code>는 다음과 같다.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sample_bow.vocabulary_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>{'나는': 1,
 '오늘': 9,
 '치킨을': 13,
 '먹을거야': 4,
 '너는': 2,
 '저녁에': 12,
 '무엇을': 5,
 '먹을거니': 3,
 '아침에': 7,
 '운동을': 11,
 '하고': 14,
 '왔어': 10,
 '어제': 8,
 '했더니': 15,
 '배가': 6,
 '고프다': 0}</code></pre>
</div>
</div>
<p>단어사전 16글자에서 어떤 단어가 등장했는지를 1로 표현하는 숫자 벡터이다.</p>
<p>데이터프레임으로 변환한 단어사전과 비교해보면 이해할 수 있다.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame([[i,j] <span class="cf">for</span> i,j <span class="kw">in</span> sample_bow.vocabulary_.items()], columns<span class="op">=</span>[<span class="st">"단어"</span>,<span class="st">"인덱스"</span>]).sort_values(<span class="st">"인덱스"</span>).reset_index(drop <span class="op">=</span> <span class="va">True</span>).T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">단어</td>
<td>고프다</td>
<td>나는</td>
<td>너는</td>
<td>먹을거니</td>
<td>먹을거야</td>
<td>무엇을</td>
<td>배가</td>
<td>아침에</td>
<td>어제</td>
<td>오늘</td>
<td>왔어</td>
<td>운동을</td>
<td>저녁에</td>
<td>치킨을</td>
<td>하고</td>
<td>했더니</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">인덱스</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>rs <span class="op">=</span> sample_bow.transform(sample_text)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>rs.toarray()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>array([[0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0],
       [0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0],
       [0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0],
       [1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1]])</code></pre>
</div>
</div>
</section>
<section id="tf-idf-term-frequency-inverse-document-frequency" class="level3">
<h3 class="anchored" data-anchor-id="tf-idf-term-frequency-inverse-document-frequency">2-2. TF-IDF (Term Frequency-Inverse Document Frequency)</h3>
<p><strong>TF-IDF</strong>는 텍스트를 숫자형 벡터로 변환하는 방법 중 하나로, 단어의 빈도(Term Frequency)에 가중치를 부여하는 방법이다.</p>
<p>단순히 단어의 빈도만을 사용하는 Bag-of-Words 모델보다 <strong>더 유용한 정보를 제공</strong>한다.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>sample_text <span class="op">=</span> [<span class="st">"나는 오늘 치킨을 먹을거야"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"너는 오늘 저녁에 무엇을 먹을거니"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"나는 오늘 아침에 운동을 하고 왔어"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"어제 저녁에 운동을 했더니 배가 고프다"</span>]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>tfidf_vectorizer <span class="op">=</span> TfidfVectorizer()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>tfidf_vector <span class="op">=</span> tfidf_vectorizer.fit_transform(sample_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tfidf_vectorizer.vocabulary_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>{'나는': 1,
 '오늘': 9,
 '치킨을': 13,
 '먹을거야': 4,
 '너는': 2,
 '저녁에': 12,
 '무엇을': 5,
 '먹을거니': 3,
 '아침에': 7,
 '운동을': 11,
 '하고': 14,
 '왔어': 10,
 '어제': 8,
 '했더니': 15,
 '배가': 6,
 '고프다': 0}</code></pre>
</div>
</div>
<p>단어사전에 해당하는 인덱스가 0,1 이 아닌 가중치가 부여됨을 확인할 수 있다.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame([[i,j] <span class="cf">for</span> i,j <span class="kw">in</span> tfidf_vectorizer.vocabulary_.items()], columns<span class="op">=</span>[<span class="st">"단어"</span>,<span class="st">"인덱스"</span>]).sort_values(<span class="st">"인덱스"</span>).reset_index(drop <span class="op">=</span> <span class="va">True</span>).T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">단어</td>
<td>고프다</td>
<td>나는</td>
<td>너는</td>
<td>먹을거니</td>
<td>먹을거야</td>
<td>무엇을</td>
<td>배가</td>
<td>아침에</td>
<td>어제</td>
<td>오늘</td>
<td>왔어</td>
<td>운동을</td>
<td>저녁에</td>
<td>치킨을</td>
<td>하고</td>
<td>했더니</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">인덱스</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tfidf_vector.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.         0.4530051  0.         0.         0.57457953 0.
  0.         0.         0.         0.36674667 0.         0.
  0.         0.57457953 0.         0.        ]
 [0.         0.         0.49819711 0.49819711 0.         0.49819711
  0.         0.         0.         0.31799276 0.         0.
  0.39278432 0.         0.         0.        ]
 [0.         0.36559366 0.         0.         0.         0.
  0.         0.46370919 0.         0.29597957 0.46370919 0.36559366
  0.         0.         0.46370919 0.        ]
 [0.43671931 0.         0.         0.         0.         0.
  0.43671931 0.         0.43671931 0.         0.         0.34431452
  0.34431452 0.         0.         0.43671931]]</code></pre>
</div>
</div>
</section>
<section id="sentencetransformer" class="level3">
<h3 class="anchored" data-anchor-id="sentencetransformer">2-3. SentenceTransformer</h3>
<p><strong>SentenceTransformer</strong>는 Transformer(영화아님, 딥러닝 모델) 기반의 사전 학습된 모델을 통하여 문장을 고차원 숫자 벡터로 변환한다.</p>
<p>TF-IDF는 단어의 빈도에 가중치를 부여하는 방식으로, 문맥을 고려하지 못한다. ex)똥맛 카레, 카레맛 똥</p>
<p><strong>SentenceTransformer</strong>는 Transformer기반 모델을 통해 문맥을 고려하여 문장 내의 단어 순서와 의미를 반영할 수 있다.</p>
<p>차원수의 차이 때문에 단순한 텍스트 분석인지, 복잡한 자연어처리 작업인지에 따라 사용하면 된다.</p>
<p><a href="https://huggingface.co/sentence-transformers/paraphrase-MiniLM-L6-v2">사용모델 paraphrase-MiniLM-L6-v2</a></p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>sample_text <span class="op">=</span> [<span class="st">"나는 오늘 치킨을 먹을거야"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"너는 오늘 저녁에 무엇을 먹을거니"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"나는 오늘 아침에 운동을 하고 왔어"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"어제 저녁에 운동을 했더니 배가 고프다"</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>sample_embedding <span class="op">=</span> SentenceTransformer(<span class="st">'paraphrase-MiniLM-L6-v2'</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>embeddings <span class="op">=</span> sample_embedding.encode(sample_text)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>embeddings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-07-30 17:28:40.050781: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-30 17:28:40.051695: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-07-30 17:28:40.054281: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-07-30 17:28:40.061751: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-07-30 17:28:40.074227: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-07-30 17:28:40.077846: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-07-30 17:28:40.087182: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-30 17:28:41.445550: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[-0.0055915 ,  0.58696157,  0.12903269, ..., -0.5404554 ,
         0.9031779 ,  0.508091  ],
       [ 0.14074272,  0.4005823 ,  0.07539973, ..., -0.30134737,
         0.9708954 ,  0.6109679 ],
       [ 0.26552293,  0.540008  ,  0.1140722 , ..., -0.55974346,
         0.8789244 ,  0.6666612 ],
       [ 0.23060054,  0.45907632,  0.08265256, ..., -0.41313243,
         1.0001894 ,  0.5942588 ]], dtype=float32)</code></pre>
</div>
</div>
<p>4 * 384의 행렬으로 변환되었다. (TF-IDF보다 큼)</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>embeddings.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(4, 384)</code></pre>
</div>
</div>
</section>
</section>
<section id="모델-적용-분류-classification" class="level2">
<h2 class="anchored" data-anchor-id="모델-적용-분류-classification">3. 모델 적용 (분류, Classification)</h2>
<p>분류 모델을 사용하여 숫자 벡터로 바꾼 텍스트 데이터가 무얼 혐오하는지 분류한다.</p>
<p>앞서 사용한 텍스트 데이터의 변환 중 BOW(CountVectorizer), TF-IDF(TfidfVectorizer) 방식을 사용한다.</p>
<p>파라미터의 의미는 다음과 같다.</p>
<ul>
<li><p><code>stop_words=</code> : 숫자 벡터로 변환하는 과정에서 무시할 단어의 리스트</p></li>
<li><p><code>ngram_range=</code> : 단어 묶음의 범위</p>
<ul>
<li>ngram_range=1이면 [“오늘”, “치킨을”]</li>
<li>ngram_range=2 면 [“오늘 치킨을”]</li>
<li>(1,2)는 [“오늘”, “치킨을”, “오늘 치킨을”] 이다</li>
</ul></li>
<li><p><code>max_df=</code> 특정 단어가 너무 자주 등장하면 무시하는 기능 (0.7 -&gt; 전체 문서의 70%이상이면 무시)</p></li>
<li><p><code>min_df=</code> 특정 단어가 너무 적게 등장하면 무시하는 기능 (10 -&gt; 10개 이하는 무시)</p></li>
</ul>
<section id="데이터-변환-적용" class="level3">
<h3 class="anchored" data-anchor-id="데이터-변환-적용">3-1. 데이터 변환 적용</h3>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>unsmile_bow <span class="op">=</span> CountVectorizer(stop_words<span class="op">=</span>[<span class="st">"으로"</span>,<span class="st">"을"</span>,<span class="st">"를"</span>,<span class="st">"은"</span>,<span class="st">"이다"</span>],</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                              ngram_range <span class="op">=</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                              max_df <span class="op">=</span> <span class="fl">0.7</span>, min_df <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>unsmile_tfidf <span class="op">=</span> TfidfVectorizer(stop_words<span class="op">=</span>[<span class="st">"으로"</span>,<span class="st">"을"</span>,<span class="st">"를"</span>,<span class="st">"은"</span>,<span class="st">"이다"</span>],</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                              ngram_range <span class="op">=</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                              max_df <span class="op">=</span> <span class="fl">0.7</span>, min_df <span class="op">=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>앞서 <code>konlpy.Kkma</code>를 사용해서 형태소 단위로 나는 데이터를 사용한다.</p>
<p><code>fit_transform()</code>메소드로 train 데이터를 학습하고, 변환하고</p>
<p><code>transform()</code> 메소드로 test 데이터를 변환한다.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X_train_bow <span class="op">=</span> unsmile_bow.fit_transform(konlpy_morphs_train)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>X_test_bow <span class="op">=</span> unsmile_bow.transform(konlpy_morphs_test)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>X_train_tfidf <span class="op">=</span> unsmile_tfidf.fit_transform(konlpy_morphs_train)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>X_test_tfidf <span class="op">=</span> unsmile_tfidf.transform(konlpy_morphs_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>y</strong>는 어떤 대상을 혐오한지의 인덱스 값이다.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">enumerate</span>(train.loc[:, <span class="st">"여성/가족"</span>:<span class="st">"clean"</span>].columns):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"인덱스[</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">] : </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>인덱스[0] : 여성/가족
인덱스[1] : 남성
인덱스[2] : 성소수자
인덱스[3] : 인종/국적
인덱스[4] : 연령
인덱스[5] : 지역
인덱스[6] : 종교
인덱스[7] : 기타 혐오
인덱스[8] : 악플/욕설
인덱스[9] : clean</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train.loc[:, <span class="st">"여성/가족"</span>:<span class="st">"clean"</span>].values.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test.loc[:, <span class="st">"여성/가족"</span>:<span class="st">"clean"</span>].values.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> y_train[:<span class="dv">2700</span>]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> y_test[:<span class="dv">1000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델-적용-로지스틱-회귀-분석" class="level3">
<h3 class="anchored" data-anchor-id="모델-적용-로지스틱-회귀-분석">3-2. 모델 적용 (로지스틱 회귀 분석)</h3>
<section id="bow-방식" class="level4">
<h4 class="anchored" data-anchor-id="bow-방식">3-2-1. BOW 방식</h4>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>logistic <span class="op">=</span> LogisticRegression()</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 학습</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>logistic.fit(X_train_bow, y_train)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>bow_pred <span class="op">=</span> logistic.predict(X_test_bow)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 분류 평가지표</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(bow_pred,y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.35      0.49      0.41        78
           1       0.59      0.69      0.64        65
           2       0.51      0.64      0.57        59
           3       0.43      0.73      0.54        66
           4       0.19      1.00      0.32         6
           5       0.55      0.76      0.64        42
           6       0.58      0.81      0.67        37
           7       0.00      0.00      0.00         5
           8       0.38      0.34      0.36       218
           9       0.74      0.45      0.56       424

    accuracy                           0.50      1000
   macro avg       0.43      0.59      0.47      1000
weighted avg       0.57      0.50      0.51      1000
</code></pre>
</div>
</div>
</section>
<section id="tf-idf-방식" class="level4">
<h4 class="anchored" data-anchor-id="tf-idf-방식">3-2-2. TF-IDF 방식</h4>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>logistic <span class="op">=</span> LogisticRegression()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 학습</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>logistic.fit(X_train_tfidf, y_train)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>tfidf_pred <span class="op">=</span> logistic.predict(X_test_tfidf)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 분류 평가지표</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(tfidf_pred,y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.33      0.55      0.41        65
           1       0.59      0.70      0.64        64
           2       0.49      0.68      0.57        53
           3       0.38      0.74      0.50        57
           4       0.19      1.00      0.32         6
           5       0.50      0.83      0.62        35
           6       0.62      0.84      0.71        38
           7       0.00      0.00      0.00         0
           8       0.41      0.35      0.38       236
           9       0.76      0.44      0.56       446

    accuracy                           0.50      1000
   macro avg       0.43      0.61      0.47      1000
weighted avg       0.58      0.50      0.51      1000
</code></pre>
</div>
</div>
</section>
<section id="sentencetransformer-방식" class="level4">
<h4 class="anchored" data-anchor-id="sentencetransformer-방식">3-2-3. SentenceTransformer 방식</h4>
<p><code>SentenceTransformer</code>방식은 시간이 오래 걸려 사전 처리된 데이터를 불러와 사용하였다.</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">## pkl 파일 불러오기기</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>test_pkl_path <span class="op">=</span> <span class="st">"/home/sungil/DXschool/data/X_test_setence_transformer3.pkl"</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>train_pkl_path <span class="op">=</span> <span class="st">"/home/sungil/DXschool/data/X_train_setence_transformer3.pkl"</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(train_pkl_path,<span class="st">"rb"</span>) <span class="im">as</span> f:</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    X_train_embedding <span class="op">=</span> pickle.load(f)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(test_pkl_path,<span class="st">"rb"</span>) <span class="im">as</span> f:</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    X_test_embedding <span class="op">=</span> pickle.load(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>X_train_embedding <span class="op">=</span> pd.DataFrame(X_train_embedding[:<span class="dv">2700</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>X_test_embedding <span class="op">=</span> pd.DataFrame(X_test_embedding[:<span class="dv">1000</span>])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 차원 수</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>X_train_embedding.shape, X_test_embedding.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>((2700, 768), (1000, 768))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>logistic <span class="op">=</span> LogisticRegression()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 학습</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>logistic.fit(X_train_embedding, y_train)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>embedding_pred <span class="op">=</span> logistic.predict(X_test_embedding)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 분류 평가지표</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(embedding_pred,y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.59      0.60      0.60       106
           1       0.63      0.55      0.59        88
           2       0.70      0.66      0.68        79
           3       0.57      0.61      0.59       103
           4       0.38      0.52      0.44        23
           5       0.60      0.66      0.63        53
           6       0.62      0.65      0.63        49
           7       0.07      0.15      0.09        13
           8       0.52      0.47      0.49       219
           9       0.60      0.58      0.59       267

    accuracy                           0.57      1000
   macro avg       0.53      0.55      0.53      1000
weighted avg       0.58      0.57      0.57      1000
</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="성능-지표-해석" class="level2">
<h2 class="anchored" data-anchor-id="성능-지표-해석">4. 성능 지표 해석</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data/classification_report.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-2.png</figcaption>
</figure>
</div>
<p>분류 결과 - acurracy (정확도) : 0.5, 0.5, 0.57 - precision (정밀도) : 0.43, 0.43, 0.53 - recall (재현률) : 0.59, 0.61, 0.55</p>
<p>세 모델 모두 분류 성능이 좋지 않다는걸 확인할 수 있다.</p>
<p>train 데이터의 <strong>클래스 불균형</strong>(4번,7번 클래스가 특히 부족)이 있었다.</p>
<p>클래스 불균형 문제를 해결하거나, 하이퍼파라미터 튜닝, 다른 분류모델 사용, 다른 벡터화 기법 사용 등을 고려해봐야 한다.</p>
</section>
<section id="파이프라인-하이퍼파라미터-튜닝" class="level2">
<h2 class="anchored" data-anchor-id="파이프라인-하이퍼파라미터-튜닝">5. 파이프라인 &amp; 하이퍼파라미터 튜닝</h2>
<p>전처리 과정을 묶고 최적의 파라미터 찾기</p>
<section id="파이프라인" class="level3">
<h3 class="anchored" data-anchor-id="파이프라인">5-1. 파이프라인</h3>
<p>텍스트 데이터를 숫자 벡터로 변환하고, 분류 모델을 평가하는 과정을 파이프라인을 통해 하나로 묶을 수 있다.</p>
<p><code>Pipeline([("이름1", 클래스1),("이름2", 클래스2)])</code></p>
<p>다음 파이프라인은 형태소로 분리한 텍스트 데이터를 받아 - TF-IDF 방식 숫자형 벡터로 변환 - 로지스틱 회귀분석</p>
<p>을 진행한다.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"tf_idf"</span>, TfidfVectorizer()),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"logi"</span>, LogisticRegression())</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 학습</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>pipeline.fit(konlpy_morphs_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('tf_idf', TfidfVectorizer()), ('logi', LogisticRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('tf_idf', TfidfVectorizer()), ('logi', LogisticRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">TfidfVectorizer</label><div class="sk-toggleable__content"><pre>TfidfVectorizer()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 평가 (Accuracy)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>pipeline.score(konlpy_morphs_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0.5</code></pre>
</div>
</div>
</section>
<section id="하이퍼파라미터-튜닝" class="level3">
<h3 class="anchored" data-anchor-id="하이퍼파라미터-튜닝">5-2. 하이퍼파라미터 튜닝</h3>
<p><strong>하이퍼 파라미터</strong>는 파라미터와 구분하여 사용자가 설정하는 값들을 모두 지칭한다.</p>
<p><code>GridSearchCV</code>를 사용하여 최적의 하이퍼파라미터 조합을 찾아낸다.</p>
<p>숫자벡터 변환, 분류 모델 들어가는 하이파파라미터들의 조합은 아주 많다. 하나하나 하기엔 오래걸리니까 한다.</p>
<p>앞서 만든 파이프라인을 사용한다.</p>
<p>{“이름1__파라미터명1” : [파라미터1,파라미터2…],<br> “이름1__파라미터명2” : [파라미터1,파라미터2…],<br> “이름2__파라미터명1” : [파라미터1,파라미터2…]}</p>
<p>으로 작성하고</p>
<p><code>GridSearchCV(pipeline, grid_params, cv=3)</code></p>
<ul>
<li>pipeline : 파이프라인</li>
<li>grid_params : 파리미터들</li>
<li>cv : Cross Validation</li>
</ul>
<p>이건 Cross Validation(교차 검증)이다.</p>
<p>학습 데이터를 n개로 나눠서 n번 학습을 하고 자체 평가를 한다.</p>
<p>성능이 좋아지지만, 시간이 오래 걸린디.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data/cross_validation.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<p>Logistic Regression의 <code>C</code>파라미터는 규제 강도를 조절한다.</p>
<p>작을수록 규제가 강해지고 높을수록 약해진다.</p>
<ul>
<li>규제가 강하면 과대적합을 방지하지만 <strong>과소적합의 위험</strong>이 있다.</li>
<li>규제가 약하면 과소적합을 방지하지만 <strong>과대적합의 위험</strong>이 있다.</li>
</ul>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>grid_params <span class="op">=</span> {</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tf_idf__ngram_range"</span> : [(<span class="dv">1</span>,<span class="dv">1</span>),(<span class="dv">1</span>,<span class="dv">2</span>),(<span class="dv">1</span>,<span class="dv">3</span>)],</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tf_idf__max_df"</span> : [<span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>],</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tf_idf__min_df"</span> : [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>],</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logi__C"</span> : [<span class="fl">0.001</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>],</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>gridsearch <span class="op">=</span> GridSearchCV(</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    pipeline,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    grid_params,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    cv <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>gridsearch.fit(konlpy_morphs_train,y_train) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[('tf_idf', TfidfVectorizer()),
                                       ('logi', LogisticRegression())]),
             param_grid={'logi__C': [0.001, 0.1, 1, 10],
                         'tf_idf__max_df': [0.5, 0.7, 0.8],
                         'tf_idf__min_df': [10, 20, 30],
                         'tf_idf__ngram_range': [(1, 1), (1, 2), (1, 3)]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[('tf_idf', TfidfVectorizer()),
                                       ('logi', LogisticRegression())]),
             param_grid={'logi__C': [0.001, 0.1, 1, 10],
                         'tf_idf__max_df': [0.5, 0.7, 0.8],
                         'tf_idf__min_df': [10, 20, 30],
                         'tf_idf__ngram_range': [(1, 1), (1, 2), (1, 3)]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('tf_idf', TfidfVectorizer()), ('logi', LogisticRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">TfidfVectorizer</label><div class="sk-toggleable__content"><pre>TfidfVectorizer()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<p>총 조합 수는 - n_gram_range 3개 - max_df 3개 - min_df 3개 - C 4개</p>
<p>으로 3x3x3x4 = 108개의 조합을 시도하고, <code>cv = 3</code>이기 때문에 각 조합마다 3번씩 학습, 총 324번을 학습한다. <br>시간이 오래 걸리는 이유이다.</p>
<p><code>best_params_</code> 메소드를 통해 최적의 하이퍼파라미터를 출력한다.</p>
<p><code>best_estimator_</code> 메소드로 최적의 파라미터로 학습한 모델을 불러온다.</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>gridsearch.best_params_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>{'logi__C': 1,
 'tf_idf__max_df': 0.5,
 'tf_idf__min_df': 10,
 'tf_idf__ngram_range': (1, 1)}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="op">=</span> gridsearch.best_estimator_</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 최적의 파라미터 모델 예측</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>best_param_pred <span class="op">=</span> best_model.predict(konlpy_morphs_test)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측 결과 지표</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, best_param_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.55      0.32      0.40       109
           1       0.71      0.62      0.66        76
           2       0.70      0.50      0.58        74
           3       0.76      0.38      0.51       111
           4       1.00      0.19      0.32        32
           5       0.83      0.52      0.64        58
           6       0.80      0.63      0.71        52
           7       0.00      0.00      0.00        30
           8       0.34      0.40      0.37       199
           9       0.44      0.76      0.56       259

    accuracy                           0.51      1000
   macro avg       0.61      0.43      0.47      1000
weighted avg       0.55      0.51      0.49      1000
</code></pre>
</div>
</div>
<p>0.51로 여전히 낮다.</p>
</section>
</section>
<section id="결과" class="level2">
<h2 class="anchored" data-anchor-id="결과">6. 결과</h2>
<p>어떤 단어가 분류에 가중치를 많이 주었는지 분류 모델을 통해 시각화 해보았다.</p>
<p>10 * 358 (혐오대상, 단어)의 가중치 행렬이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>weight <span class="op">=</span> best_model.steps[<span class="dv">1</span>][<span class="dv">1</span>].coef_</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>weight.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(10, 358)</code></pre>
</div>
</div>
<p>혐오 대상별 단어 시각화 함수</p>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.font_manager <span class="im">as</span> fm</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> squarify</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_x(x):</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    vocab <span class="op">=</span> best_model.steps[<span class="dv">0</span>][<span class="dv">1</span>].vocabulary_</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    weight <span class="op">=</span> best_model.steps[<span class="dv">1</span>][<span class="dv">1</span>].coef_</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame([vocab.keys(), vocab.values()]).T</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    df.sort_values(by<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"W"</span>] <span class="op">=</span> weight[x]</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">'단어'</span>, <span class="st">"인덱스"</span>, <span class="st">"가중치"</span>]</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    df.set_index(<span class="st">'인덱스'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.sort_values(<span class="st">'가중치'</span>, ascending<span class="op">=</span><span class="va">False</span>).head())</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    fontpath <span class="op">=</span> <span class="st">'/usr/share/fonts/truetype/nanum/NanumGothic.ttf'</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    font_name <span class="op">=</span> fm.FontProperties(fname<span class="op">=</span>fontpath, size<span class="op">=</span><span class="dv">10</span>).get_name()</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    plt.rc(<span class="st">'font'</span>, family<span class="op">=</span>font_name)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    sizes <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'가중치'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">30</span>)[<span class="st">'가중치'</span>]</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'가중치'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">30</span>)[<span class="st">'단어'</span>]</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    norm <span class="op">=</span> matplotlib.colors.Normalize(vmin<span class="op">=</span><span class="bu">min</span>(sizes),vmax<span class="op">=</span><span class="bu">max</span>(sizes))</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> [matplotlib.cm.Reds(norm(value)) <span class="cf">for</span> value <span class="kw">in</span> sizes]</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>    squarify.plot(sizes, <span class="dv">10</span>, <span class="dv">10</span>, label<span class="op">=</span>labels, color<span class="op">=</span>colors,bar_kwargs<span class="op">=</span><span class="bu">dict</span>(linewidth<span class="op">=</span><span class="dv">8</span>, edgecolor<span class="op">=</span><span class="st">"#eee"</span>))</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"혐오에 활용되는 주요 키워드"</span>)</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">enumerate</span>(train.loc[:, <span class="st">"여성/가족"</span>:<span class="st">"clean"</span>].columns):</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"인덱스[</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">] : </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>인덱스[0] : 여성/가족
인덱스[1] : 남성
인덱스[2] : 성소수자
인덱스[3] : 인종/국적
인덱스[4] : 연령
인덱스[5] : 지역
인덱스[6] : 종교
인덱스[7] : 기타 혐오
인덱스[8] : 악플/욕설
인덱스[9] : clean</code></pre>
</div>
</div>
<section id="여성가족" class="level3">
<h3 class="anchored" data-anchor-id="여성가족">6-1. 여성/가족</h3>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     단어       가중치
인덱스              
347  한남  6.890850
281  자지  3.586034
93   댕이  3.065344
69   냄져  3.052125
253  이기  2.174341</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="남성" class="level3">
<h3 class="anchored" data-anchor-id="남성">6-2. 남성</h3>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     단어       가중치
인덱스              
347  한남  6.890850
281  자지  3.586034
93   댕이  3.065344
69   냄져  3.052125
253  이기  2.174341</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-43-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="성소수자" class="level3">
<h3 class="anchored" data-anchor-id="성소수자">6-3. 성소수자</h3>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       단어       가중치
인덱스                
100   동성애  4.647741
101  동성애자  3.780582
23     게이  3.533253
58     꼬충  3.243192
110    똥꼬  2.903039</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-44-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="인종국적" class="level3">
<h3 class="anchored" data-anchor-id="인종국적">6-4. 인종/국적</h3>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      단어       가중치
인덱스               
309  조선족  3.923741
316   중국  3.445646
84   다문화  3.265852
65    난민  2.721175
333  탈북자  2.499918</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-45-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="연령" class="level3">
<h3 class="anchored" data-anchor-id="연령">6-5. 연령</h3>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      단어       가중치
인덱스               
50    급식  4.551949
64    나이  1.496709
169   새끼  1.333710
236  올라오  1.199835
204   안되  1.141374</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="지역" class="level3">
<h3 class="anchored" data-anchor-id="지역">6-6. 지역</h3>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      단어       가중치
인덱스               
293  전라도  4.621232
355   홍어  4.062138
193   쌍도  3.432531
90    대구  2.994224
26   경상도  2.916873</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-47-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="종교" class="level3">
<h3 class="anchored" data-anchor-id="종교">6-7. 종교</h3>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     단어       가중치
인덱스              
19   개독  3.961684
127  목사  3.946740
186  슬람  3.435409
312  종교  3.332901
31   교회  2.903494</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-48-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="기타-혐오" class="level3">
<h3 class="anchored" data-anchor-id="기타-혐오">6-8. 기타 혐오</h3>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      단어       가중치
인덱스               
159  빨갱이  2.602123
325   차별  1.430154
231   역시  1.243613
184   수준  1.189651
49   금지법  1.188665</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-49-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="악플-욕설" class="level3">
<h3 class="anchored" data-anchor-id="악플-욕설">6-9. 악플/ 욕설</h3>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     단어       가중치
인덱스              
195  씨받  1.576897
297  정권  1.286304
319  지랄  1.248540
15   가지  1.229520
188  시발  1.163751</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-50-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="clean" class="level3">
<h3 class="anchored" data-anchor-id="clean">6-10. clean</h3>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>plot_x(<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      단어       가중치
인덱스               
10   ㅂ니다  1.375340
244   원래  1.253776
71    네요  1.123729
137   미국  1.089941
146   범죄  0.916220</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="텍스트마이닝_sample_files/figure-html/cell-51-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>